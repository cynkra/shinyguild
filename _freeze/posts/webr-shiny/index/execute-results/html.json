{
  "hash": "0be483e903574f3502bb76b8db173fa1",
  "result": {
    "markdown": "---\ntitle: \"webR and Shiny\"\nauthor: \"David Granjon\"\ndate: \"2023-09-27\"\ncategories: [news]\n---\n\n\n![](webr-shiny.png){width=\"25%\" fig.align=\"center\"}\n\n\n\n\n\n## Introduction\n\n[`webR`](https://github.com/r-wasm/webr/) allows to run R in the browser without any installation. That was one of the main motivation for its creator, George Stagg. The goal of this article is not to describe how webR was developed but what you can do with it.\n\nUnder the hood, webR is a JavaScript package which can be downloaded from `npm` (see it as a sort of CRAN for JS packages but fairly less strict regarding the content formatting). As you may imagine, one can't use the existing CRAN repositories as they are not made for web assembly (wasm), which powers webR. Therefore, the webR team made it possible to compile your own packages, owing to a rather complex toolchain involving [Emscripten](https://emscripten.org/). The currently provided repository is deployed at https://repo.r-wasm.org/.\n\n[shinylive](https://github.com/posit-dev/shinylive) is a JavaScript app (React) leveraging webR as well as Pyodide (See more [here](https://shiny.posit.co/py/docs/shinylive.html#:~:text=Shinylive%20allows%20you%20to%20run,connect%20via%20the%20web%20browser.)), a Python web browser version. In this article, we'll only focus on the R side but keep in mind that the shinylive repository supports both. This repository allows to export a working shinylive app.\n\nThe resulting app may have different layouts:\n\n- App only.\n- App + header for sharing code.\n- App + editor + terminal.\n- App + examples... That's the one you can access [here](https://shinylive.io/r/examples/).\n\nA tiny R package called [`{shinylive}`](https://github.com/posit-dev/r-shinylive) creates plug and play shiny apps for the browser by downloading all the necessary files from the [shinylive](https://github.com/posit-dev/shinylive) repository. Be careful not to be confused!\n\nA cool feature about the shinylive app is code sharing. The app code is compressed to base64 and shared via the url. Therefore, you can build your app in the editor and share it to others.\n\n## Customizing it\n\nWhat if you want to install packages not available on https://repo.r-wasm.org/? You'd have to compile your own packages as described earlier:\n\n- Build webR and all the system libraries.\n- Build this [repository](https://github.com/r-wasm/webr-repo) and add your packages to the existing `https://github.com/r-wasm/webr-repo/blob/main/repo-packages` list. Note that in the `Makefile` you'll have to give the link to the webR installation by passing `WEBR_ROOT=<WEBR_PATH>`.\n\nThat's really not straightforward.\n\nI was able to compile a customized [repository](https://github.com/RinteRface/rinterface-webr-repo) which powers my own shinylive [app](https://github.com/RinteRface/rinterface-shinylive). I had to slightly change the code to remove the Python support, as it was not necessary.\n\n## Usage examples\n\n- `{pkgdown}` + shinylive: https://github.com/DivadNojnarg/shinylivePkgDown.\n- shinylive + quarto: have a shiny app without having to go back and forth between windows.\n\n### Embedded app\n\nBelow is an embedded R shinylive app running in a separate server. The iframe is included in a `{bslib}` card. \n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"card bslib-card bslib-mb-spacing html-fill-item html-fill-container\" data-bslib-card-init data-full-screen=\"false\" data-require-bs-caller=\"card()\" data-require-bs-version=\"5\">\n<div class=\"card-body bslib-gap-spacing html-fill-item html-fill-container\" style=\"margin-top:auto;margin-bottom:auto;flex:1 1 auto;\">\n<iframe class=\"html-fill-item\" src=\"https://shinylive.rinterface.com/app/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMAGwEsAjAJykYE8AKAZwAtaJWAlAB0IdJiw71OAFgAiUHsIgiArrQAEAHgC06gCYLu9Iiz0AFKAHM47EevWlapanHUBedULAAhIgA91AEEzAEkvXDt9Q2NTAAk4KD04RnYBCIh7Ax4Yxj0AZVok+hZU9Mzok1zfPQ5I+1IrTgASTlJWF1swYxr1EHViggBrS0YiFQg9bWJqIkZEdUtuIlaAd15yAF8vNLr1ADNqNT0sIhXbDPtLqAJHEm8VUlISTqfLSxcAfWM-cM8wABUiG8XOpfD8wDsLpd1NdbhB7o9nl5GHAYEQAG5wL7+X5eLCojGuMG-AjUBScdx-eiWbQGCDWRjbMrQmE3Wh3B5PCCdFGtWZY764sD4vko0E4vDqUnkyleanaTgqAgEOCcThM3b2WHs+GcpFgFSoAzkbHg3B-ACqRqg5HFZqlZLVsq6NNQjFoMAk212kOhTFKu2+5xZ6hWhVI3EpAEYAEzM6GOZyuDzkPykADyD1QD063w+rRtcA1UMuXjB-SINXCmvUhWdMFYgrwNemZNQnAYII8-ywFoAovHLqTllB6F31D3+4P7KgZhmszmvLOiKRvSWlPYlEoRJxkpjGFpdHtxmznnxs6RzWNSBfzbu1TqBL1IteL01l6RD+oURNkmY5+wIC7CiACO7AAITng8TQNt8TStmgu56BulwfuwjAQLMMDsDGAAMuECChGwoS+C6kE0eYFraOjfhQSSMP8cBpoBuxUa4NG0Hs6jsFB5Gwf48FENQbZIU+XgIe2cB6F46hwNQu5-CeQkiVJXi7KgCjkJ0ACyrAVgEtDqpKbFESRFxEFIe5wH2mJkDxEBvq87wCv45pASWhrGnAYKdPx9raiQzpOS4a72MRkQvpZjCYjZFCkPZb4omimKmm5uyeYWPleH5vwBRkHjIgSmKheo4UXJFu7RdZtnxbxTS8k8KKpc+HnWuQWVgDlkp5c6DX8iVZX2BVVmxXZdUZSa3xpa1XlZSWQ2dY2ErmjWPUFQabVFpKNZEKgcIUh4dCtMGIYOE447cDGnQAHJwCsZ1Jr8WRGJUejeIk1jsFG5rTLMzpuh6XoQr6p1USoB1-HSDK4vNlycEJhTxIkySUpOA41vYYZ6BGlLSDWKGbpEg2eOZUUxTVCXQX5TTooZnZwNN0ISUhX6cdxdXU8zUliYQymIapYCyfJrheEpwn89JYC7LTHZjuxuhs5TfFLX4NN03LPMy-TMlyQpXi8HoSTKFLJbwGqVjy+oGmtDYXi6fptZGT9fOSXoK0oBMvxaxrrFLCs10rpxtAEDaOrsGbnAW+abSoMmfwrCwEB8JYT0qMwcLRqZIhbMoEA8HwrCBOg7BqHeVmMEoYAbLg4DQPAVCyH2eQAMJYCEZj-CE6bXXgvNkHFVD-OdcDzPEwlEOoeS8Pw4EiIEDxLHM6jyLTejqAA4swEAAFYkBgc8L7MFqMNQ8zcI8qCIAA9Ff7r94wezXHAGDEDAIgADLBxQu7zNpIT-CIWQhlZxQFYNpSsI9J5+xDruEQ-xGjzGsI8ZOCoGiMHINJCA-xWCx3mFPAuIgq410gLABAyB8SJHgBgGAehe7EH7pQZA-xeAUkMjCDIY8ZjqAAOqzGoGvfB-AYToH3hAKuABdIAA&amp;h=0\" height=\"700\" width=\"100%\" style=\"border: 1px solid rgba(0,0,0,0.175); border-radius: .375rem;\" allowfullscreen=\"\" allow=\"autoplay\" data-external=\"1\"></iframe>\n</div>\n<bslib-tooltip placement=\"auto\" bsOptions=\"[]\" data-require-bs-version=\"5\" data-require-bs-caller=\"tooltip()\">\n<template>Expand</template>\n<span class=\"bslib-full-screen-enter badge rounded-pill\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" style=\"height:1em;width:1em;fill:currentColor;\" aria-hidden=\"true\" role=\"img\"><path d=\"M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z\"/></svg></span>\n</bslib-tooltip>\n<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>\n</div>\n```\n:::\n:::\n\n\n### Embedded app + editor\n\nAn embedded shinylive app editor. User can share the code. Note: the plot won't likely show on smaller screen leading to an error in the R console.\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"card bslib-card bslib-mb-spacing html-fill-item html-fill-container\" data-bslib-card-init data-full-screen=\"false\" data-require-bs-caller=\"card()\" data-require-bs-version=\"5\">\n<div class=\"card-body bslib-gap-spacing html-fill-item html-fill-container\" style=\"margin-top:auto;margin-bottom:auto;flex:1 1 auto;\">\n<iframe class=\"html-fill-item\" src=\"https://shinylive.rinterface.com/editor/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMAGwEsAjAJykYE8AKAZwAtaJWAlAB0IdJiw71OAFgAiUHsIgiArrQAEAHgC06gCYLu9Iiz0AFKAHM47EevWlapanHUBedULAAhIgA91AEEzAEkvXDt9Q2NTAAk4KD04RnYBCIh7Ax4Yxj0AZVok+hZU9Mzok1zfPQ5I+1IrTgASTlJWF1swYxr1EHViggBrS0YiFQg9bWJqIkZEdUtuIlaAd15yAF8vNLr1ADNqNT0sIhXbDPtLqAJHEm8VUlISTqfLSxcAfWM-cM8wABUiG8XOpfD8wDsLpd1NdbhB7o9nl5GHAYEQAG5wL7+X5eLCojGuMG-AjUBScdx-eiWbQGCDWRjbMrQmE3Wh3B5PCCdFGtWZY764sD4vko0E4vDqUnkyleanaTgqAgEOCcThM3b2WHs+GcpFgFSoAzkbHg3B-ACqRqg5HFZqlZLVsq6NNQjFoMAk212kOhTFKu2+5xZ6hWhVI3EpAEYAEzM6GOZyuDzkPykADyD1QD063w+rRtcA1UMuXjB-SINXCmvUhWdMFYgrwNemZNQnAYII8-ywFoAovHLqTllB6F31D3+4P7KgZhmszmvLOiKRvSWlPYlEoRJxkpjGFpdHtxmznnxs6RzWNSBfzbu1TqBL1IteL01l6RD+oURNkmY5+wIC7CiACO7AAITng8TQNt8TStmgu56BulwfuwjAQLMMDsDGAAMuECChGwoS+C6kE0eYFraOjfhQSSMP8cBpoBuxUa4NG0Hs6jsFB5Gwf48FENQbZIU+XgIe2cB6F46hwNQu5-CeQkiVJXi7KgCjkJ0ACyrAVgEtDqpKbFESRFxEFIe5wH2mJkDxEBvq87wCv45pASWhrGnAYKdPx9raiQzpOS4a72MRkQvpZjCYjZFCkPZb4omimKmm5uyeYWPleH5vwBRkHjIgSmKheo4UXJFu7RdZtnxbxTS8k8KKpc+HnWuQWVgDlkp5c6DX8iVZX2BVVmxXZdUZSa3xpa1XlZSWQ2dY2ErmjWPUFQabVFpKNZEKgcIUh4dCtMGIYOE447cDGnQAHJwCsZ1Jr8WRGJUejeIk1jsFG5rTLMzpuh6XoQr6p1USoB1-HSDK4vNlycEJhTxIkySUpOA41vYYZ6BGlLSDWKGbpEg2eOZUUxTVCXQX5TTooZnZwNN0ISUhX6cdxdXU8zUliYQymIapYCyfJrheEpwn89JYC7LTHZjuxuhs5TfFLX4NN03LPMy-TMlyQpXi8HoSTKFLJbwGqVjy+oGmtDYXi6fptZGT9fOSXoK0oBMvxaxrrFLCs10rpxtAEDaOrsGbnAW+abSoMmfwrCwEB8JYT0qMwcLRqZIhbMoEA8HwrCBOg7BqHeVmMEoYAbLg4DQPAVCyH2eQAMJYCEZj-CE6bXXgvNkHFVD-OdcDzPEwlEOoeS8Pw4EiIEDxLHM6jyLTejqAA4swEAAFYkBgc8L7MFqMNQ8zcI8qCIAA9Ff7r94wezXHAGDEDAIgADLBxQu7zNpIT-CIWQhlZxQFYNpSsI9J5+xDruEQ-xGjzGsI8ZOCoGiMHINJCA-xWCx3mFPAuIgq410gLABAyB8SJHgBgGAehe7EH7pQZA-xeAUkMjCDIY8ZjqAAOqzGoGvfB-AYToH3hAKuABdIAA\" height=\"700\" width=\"100%\" style=\"border: 1px solid rgba(0,0,0,0.175); border-radius: .375rem;\" allowfullscreen=\"\" allow=\"autoplay\" data-external=\"1\"></iframe>\n</div>\n<bslib-tooltip placement=\"auto\" bsOptions=\"[]\" data-require-bs-version=\"5\" data-require-bs-caller=\"tooltip()\">\n<template>Expand</template>\n<span class=\"bslib-full-screen-enter badge rounded-pill\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" style=\"height:1em;width:1em;fill:currentColor;\" aria-hidden=\"true\" role=\"img\"><path d=\"M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z\"/></svg></span>\n</bslib-tooltip>\n<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>\n</div>\n```\n:::\n:::\n\n\n### Quarto slides\n\nBelow is a simple shiny app embedded in a quarto revealjs presentation. To get it working you must:\n\n- Install the shinylive quarto extension, run within your project:\n  ```bash\n  quarto add quarto-ext/shinylive\n  ```\n  \n- Edit `index.qmd` by passing the appropriate filter:\n  ```yaml\n  ---\n  ... other options ...\n  filters: \n    - shinylive\n  ---\n  ```\n\n- Create the app code:\n  ````bash\n  ```{shinylive-r}\n  #| standalone: true\n  #| components: [editor, viewer]\n  #| column: screen-inset-shaded\n  library(\"shiny\")\n  \n  ui <- fluidPage(\n    numericInput(\"obs\", \"Number of observations:\",\n      min = 0, max = 1000, value = 500\n    ),\n    plotOutput(\"distPlot\")\n  )\n  \n  # Server logic\n  server <- function(input, output) {\n    output$distPlot <- renderPlot({\n      hist(rnorm(input$obs))\n    })\n  }\n  \n  shinyApp(ui, server)\n  ```\n  ````\n  \nThe result is shown below. As you can see, there is currently a layout issue, as there is an offset in the editor pane.\n\n\n```{=html}\n<iframe width=\"100%\" height=\"800px\" class=\"slide-deck\" src=\"revealjs-demo/\"></iframe>\n```\n\n\n## Limitations\n\nCurrently, there are few limitations:\n\n- Have to install all packages on app load, which takes some time for R. It will be fixed soon.\n- Necessary to have your own CRAN-like for wasm at some point. The webR team won't be able to compile any single package on request.\n- Few R functions don't work well.\n- Data are available in the browser. Not suitable for clinical apps in the pharma world, except if data are publicly made available on purpose (synthetic data ...).\n\nI personally think webR will be great for teaching and presentations. However, I don't see it replacing the current infrastructures for more complex apps.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.6/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/bslib-webComponents-js-0.5.1.9000/webComponents.min.js\" type=\"module\"></script>\n<script src=\"../../site_libs/bslib-tag-require-0.5.1.9000/tag-require.js\"></script>\n<script src=\"../../site_libs/bslib-card-js-0.5.1.9000/card.min.js\"></script>\n<link href=\"../../site_libs/bslib-card-styles-0.5.1.9000/card.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}